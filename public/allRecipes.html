<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Todas las Recetas</title>
    <link rel="icon" href="assets/images/faviicon/favicon.ico" />
    <!-- for icons  -->
    <link rel="stylesheet" href="https://unicons.iconscout.com/release/v4.0.0/css/line.css">
    <!-- bootstrap  -->
    <link rel="stylesheet" href="assets/css/bootstrap.min.css">
    <!-- for swiper slider  -->
    <link rel="stylesheet" href="assets/css/swiper-bundle.min.css">
    <!-- fancy box  -->
    <link rel="stylesheet" href="assets/css/jquery.fancybox.min.css">
    <!-- custom css  -->
    <link rel="stylesheet" href="assets/css/style.css">
    <!-- chatbot css  -->
    <link rel="stylesheet" href="chatbot/css/chat.css">
    <!-- font awesome-->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">

    <style>
        .btn-save {
            width: 130px !important;
            /* Ancho reducido para pantallas pequeñas */
            height: 55px !important;
            /* Altura reducida */
            font-size: 0.9em;
            /* Tamaño del texto reducido */
            padding: px;
            /* Relleno reducido */
            background: #28a745;
            color: white;
        }

        .btn-save:hover {
            background: #146b28;
        }

        .modal {
            position: fixed !important;
            z-index: 1000 !important;
            top: 50% !important;
            left: 50% !important;
            transform: translate(-50%, -50%) !important;
            background: rgba(255, 255, 255, 0) !important;
            padding: 5px !important;
            border: 1px solid #dddddd00 !important;
            border-radius: 10px !important;
            box-shadow: 0 10px 20px rgba(0, 0, 0, 0) !important;
            max-width: 900px !important;
        }

        /* Media query para cuando la resolución es menor de 430 píxeles */
        @media (max-width: 1280px) {
            .btn-save {
                width: 90px !important;
                /* Ancho reducido para pantallas pequeñas */
                height: 55px !important;
                /* Altura reducida */
                font-size: 0.9em;
                /* Tamaño del texto reducido */
                padding: px;
                /* Relleno reducido */
                background: #28a745;
                color: white;
            }

            .btn-save:hover {
                background: #146b28;
            }

            .form-container {
                max-width: 900px !important;

            }

            .modal {
                position: fixed !important;
                z-index: 1000 !important;
                top: 50% !important;
                left: 50% !important;
                transform: translate(-50%, -50%) !important;
                background: rgba(255, 255, 255, 0) !important;
                padding: 5px !important;
                border: 1px solid #dddddd00 !important;
                border-radius: 10px !important;
                box-shadow: 0 10px 20px rgba(0, 0, 0, 0) !important;
                max-width: 900px !important;
                max-height: 700px !important;
                margin-bottom: 900px !important;
            }
        }
        /* Media query para cuando la resolución es menor de 430 píxeles */
        @media (min-width: 1225px) {
            .btn-save {
                width: 90px !important;
                /* Ancho reducido para pantallas pequeñas */
                height: 55px !important;
                /* Altura reducida */
                font-size: 0.9em;
                /* Tamaño del texto reducido */
                padding: px;
                /* Relleno reducido */
                background: #28a745;
                color: white;
            }

            .btn-save:hover {
                background: #146b28;
            }

            .form-container {
                max-width: 900px !important;

            }

            .modal {
                position: fixed !important;
                z-index: 1000 !important;
                top: 50% !important;
                left: 50% !important;
                transform: translate(-50%, -50%) !important;
                background: rgba(255, 255, 255, 0) !important;
                padding: 5px !important;
                border: 1px solid #dddddd00 !important;
                border-radius: 10px !important;
                box-shadow: 0 10px 20px rgba(0, 0, 0, 0) !important;
                max-width: 900px !important;
                max-height: 700px !important;
                margin-bottom: 900px !important;
                overflow: hidden;
            }
        }

        #logoutNotificationContainer {
            position: fixed;
            bottom: 0;
            /* Mantener en la parte inferior */
            left: 0;
            width: 100%;
            /* Ocupar todo el ancho */
            z-index: 999;
            /* Asegurarse de que esté por encima de otros elementos */
            background-color: #f8f9fa;
            /* Fondo para el contenedor */
            padding: 10px;
            /* Espaciado interno */
        }

        /* Barra de progreso verde */
        .progress-bar-green {
            background-color: rgb(255, 146, 82);
            /* Color verde para éxito */
        }

        /* Estilo para el mensaje de cierre de sesión */
        .alert-success {
            color: rgb(170, 73, 16);
            /* Color del texto para el mensaje de éxito */
            background-color: rgb(230, 210, 199);
            /* Fondo verde claro */
            border-color: #c3e6cb;
            /* Borde del mismo tono */
        }

        .alert {
            display: flex;
            justify-content: center;
            align-items: center;
        }


        .form-container {
            width: 100%;
            max-width: 600px;
            margin: 20px auto;
            background: rgba(255, 255, 255, 0.8);
            padding: 30px;
            border-radius: 10px;
            box-shadow: 0 10px 20px rgba(0, 0, 0, 0.1);
            text-align: left;
        }

        .btn-red1 {
            background-color: #ff8243;
            color: white;
            border: none;
            transition: background-color 0.3s;
        }

        .btn-red1:hover {
            background-color: rgb(224, 93, 6);
            color: white;
        }

        .btn-green {
            background-color: #2ad11b;
            color: white;
            border: none;
            transition: background-color 0.3s;
            width: 200px;
            height: 200px;

        }

        .btn-green:hover {
            background-color: rgb(20, 161, 27);
            color: white;
        }

        .site-footer {
            position: fixed;
            /* Mantener el footer fijo al fondo de la pantalla */
            bottom: 0;
            /* Asegurarse de que esté en la parte inferior */
            width: 100%;
            /* Asegurar que ocupe todo el ancho de la pantalla */
            z-index: 100;
            margin-top: 100px;
            /* Añadir margen superior para separar del formulario */
            /* Para mantenerlo por encima de otros elementos */
        }

        .dish-add-btn {
            margin-top: 0px;
            margin-bottom: 30px;
        }

        .dish-box {
            display: flex;
            flex-direction: column;
            justify-content: space-between;
            align-items: center;
            padding: 15px;
        }

        .dish-title {
            white-space: normal;
            /* Permite que el texto se envuelva si es necesario */
            overflow: visible;
            /* Permite ver todo el texto */
            padding: 5px;
            margin-bottom: 50px
                /* Espacio interno para evitar cortes */
        }

        /* Ajustar tamaño del texto para darle más espacio */
        .h3-title {
            font-size: 1.2em;
            /* Cambia el tamaño según tus necesidades */
            line-height: 1.5;
            /* Aumenta la altura de línea para más espacio vertical */
        }

        @media (max-width: 430px) {
            .menu-list-row {
                margin-bottom: 100px;
                /* Aumentar el margen inferior para crear separación antes del footer */
            }

            .site-footer {
                margin-top: 40px;
                /* Aumentar el margen superior del footer para crear más espacio */
                position: fixed;
                /* Mantener el footer fijo al fondo de la pantalla */
                bottom: 0;
                /* Asegurarse de que esté en la parte inferior */
                width: 100%;
                /* Asegurar que ocupe todo el ancho de la pantalla */
                z-index: 100;
                /* Asegurarse de que esté por encima de otros elementos */
            }

            #viewport {
                min-height: 100vh;
                /* Asegurar que el contenido principal tenga altura suficiente */
                display: flex;
                /* Mantener la estructura flexible */
                flex-direction: column;
                /* Alinear verticalmente */
            }

            #js-scroll-content {
                flex-grow: 1;
                /* Asegura que el contenido crezca para ocupar el espacio disponible */
            }
        }
    </style>
</head>

<body>
    <!-- Contenedor para el mensaje de cierre de sesión y la barra de progreso -->
    <div id="logoutNotificationContainer"
        style="display: none; position: fixed; bottom: 0; left: 0; width: 100%; z-index: 999; background-color: #f8f9fa; text-align: center;">
        <!-- Barra de progreso para el cierre de sesión -->
        <div id="logoutProgressBar" class="progress" style="height: 5px;">
            <div class="progress-bar progress-bar-striped progress-bar-animated progress-bar-green" role="progressbar"
                style="width: 0%;">
            </div>
        </div>

        <!-- Mensaje para el cierre de sesión -->
        <div id="logoutSuccessMessage" class="alert alert-success" style="margin: 0;">
            Cerrando sesión...
        </div>
    </div>
    <header class="site-header">
        <div class="container">
            <div class="row">
                <div class="col-lg-2 mt-4">
                    <div class="header-logo">
                        <img src="assets/images/logo.png" width="300" height="100" alt="Logo">
                    </div>
                </div>
                <div class="col-lg-10">
                    <div class="main-navigation">
                        <button class="menu-toggle"><span></span><span></span></button>
                        <nav class="header-menu">
                            <ul class="menu food-nav-menu">
                                <li><a href="home-admin.html">Inicio</a></li>
                                <li><a href="form.html">Agregar Pacientes</a></li>
                                <li><a href="view-patients.html">Ver Pacientes</a></li>
                                <li><a href="allRecipes.html">Ver Recetas</a></li>
                                <li><a href="home1.html">Cerrar Sesión</a></li>
                            </ul>
                        </nav>
                    </div>
                </div>
            </div>
        </div>
    </header>
    <!-- Home -->
    <div id="viewport">
        <div id="js-scroll-content">
            <section style="background-image: url(assets/images/background/menu-bg.png);"
                class="our-menu section bg-light repeat-img" id="menu">
                <div class="book-table-shape">
                    <img src="assets/images/background/table-leaves-shape.png" alt="">
                </div>

                <div class="book-table-shape book-table-shape2">
                    <img src="assets/images/background/table-leaves-shape.png" alt="">
                </div>
                <div class="js-parallax-scene">
                    <div class="banner-shape-1 w-100" data-depth="0.30">
                        <img src="assets/images/background/berry.png" alt="">
                    </div>
                    <div class="banner-shape-2 w-100" data-depth="0.25">
                        <img src="assets/images/background/leaf.png" alt="">
                    </div>
                </div>
                <div class="sec-wp">
                    <div class="container">
                        <div class="row">
                            <div class="col-lg-12">
                                <div class="sec-title text-center mb-5">
                                    <p class="sec-sub-title mb-3 mt-5">Nuevas Recetas</p>
                                    <h2 class="h2-title">Añadir una nueva receta</h2>
                                    <div class="sec-title-shape mb-4">
                                        <img src="assets/images/figure/title-shape.svg" alt="">
                                    </div>
                                </div>

                                <!-- Parte del HTML antes de la sección de recetas -->
                                <form id="add-recipe-form" class="form-container" enctype="multipart/form-data">
                                    <div class="form-group">
                                        <label para="recipe-name">Nombre de la receta</label>
                                        <input type="text" id="recipe-name" class="form-control" required>
                                    </div>

                                    <div class="form-group mt-3">
                                        <label para="recipe-image">Imagen (subir archivo)</label>
                                        <input type="file" id="recipe-image" class="form-control" name="image"
                                            accept="image/*" required>
                                    </div>

                                    <div class="form-group mt-3">
                                        <label para="recipe-ingredients">Ingredientes</label>
                                        <textarea id="recipe-ingredients" class="form-control" required></textarea>
                                    </div>

                                    <div class="form-group mt-3">
                                        <label para="recipe-preparation">Preparación</label>
                                        <textarea id="recipe-preparation" class="form-control" required></textarea>
                                    </div>

                                    <div class="form-group mt-3">
                                        <label para="recipe-level">Nivel de adaptación</label>
                                        <select id="recipe-level" class="form-control" required>
                                            <option value="">Seleccione nivel de adaptación</option>
                                            <option value="1">Nivel 1</option>
                                            <option value="2">Nivel 2</option>
                                            <option value="3">Nivel 3</option>
                                            <option value="4">Nivel 4</option>
                                            <option value="5">Nivel 5</option>
                                            <option value="6">Nivel 6</option>
                                            <option value="7">Nivel 7</option>
                                        </select>
                                    </div>

                                    <div style="text-align: center;">
                                        <button type="submit" class="btn btn-red1 mt-3">Agregar receta</button>
                                    </div>
                                    <div id="add-recipe-message"></div>
                                    <!-- Barra de progreso para agregar receta -->
                                    <div id="addRecipeProgressBar" class="progress" style="height: 5px; display: none;">
                                        <div class="progress-bar progress-bar-striped progress-bar-animated progress-bar-green"
                                            role="progressbar" style="width: 0%;">
                                        </div>
                                    </div>

                                    <!-- Mensaje para agregar receta -->
                                    <div id="addRecipeInfoMessage" class="alert alert-success" style="display: none;">
                                        Agregando receta...
                                    </div>

                                    <!-- Mensaje de éxito centrado -->
                                    <div id="add-recipe-message" class="alert alert-success"
                                        style="display: none; text-align: center;">
                                        Receta agregada con éxito!
                                    </div>

                                    <!-- Mensaje para errores al agregar receta -->
                                    <div id="addRecipeErrorMessage" class="alert alert-danger" style="display: none;">
                                        Error al agregar receta.
                                    </div>
                                </form>
                            </div>
                        </div>
                    </div>
                </div>
            </section>

            <section class="about-sec section" id="about"
                style="background-image: url(assets/images/background/blog-pattern-bg.png);">
                <div class="book-table-shape">
                    <img src="assets/images/background/table-leaves-shape.png" alt="">
                </div>

                <div class="book-table-shape book-table-shape2">
                    <img src="assets/images/background/table-leaves-shape.png" alt="">
                </div>
                <div class="container">
                    <div class="row">
                        <div class="col-lg-12">
                            <div class="sec-title text-center mb-5">
                                <p class="sec-sub-title mb-3">Recetas</p>
                                <h2 class="h2-title">Todas las recetas disponibles</h2>
                                <div class="sec-title-shape mb-4">
                                    <img src="assets/images/figure/title-shape.svg" alt="">
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="menu-tab-wp">
                        <div class="row">
                            <div class="col-lg-12 m-auto">
                                <div class="menu-tab text-center">
                                    <ul class="filters">
                                        <div class="filter-active"></div>
                                        <!-- Barra para el filtro activo -->
                                        <!-- Niveles de recetas -->
                                        <li class="filter" data-filter=".all">Todos</li>
                                        <li class="filter" data-filter=".level1">Nivel 1</li>
                                        <li class="filter" data-filter=".level2">Nivel 2</li>
                                        <li class="filter" data-filter=".level3">Nivel 3</li>
                                        <li class="filter" data-filter=".level4">Nivel 4</li>
                                        <li class="filter" data-filter=".level5">Nivel 5</li>
                                        <li class="filter" data-filter=".level6">Nivel 6</li>
                                        <li class="filter" data-filter=".level7">Nivel 7</li>
                                    </ul>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div id="recipe-container" class="row">
                        <!-- Contenedor para recetas -->
                    </div>
                </div>
            </section>
        </div>

        <!-- Modal para editar recetas -->
        <div id="edit-recipe-modal" class="modal"
            style="display: none; position: fixed; z-index: 1000; top: 50%; left: 50%; transform: translate(-50%, -50%); background: white; padding: 0px; border: 1px sólido #ddd; border-radius: 10px; box-shadow: 0 10px 20px rgba(0, 0, 0, 0.2); max-width: 1200px; max-height: 800px;">
            <div class="modal-content" style="text-align: center;">
                <div style="display: flex; justify-content: flex-end;">
                    <span class="close" style="cursor: pointer; font-size: 30px;">&times;</span>
                </div>
                <h3 class="mt-1" style="font-size: 1.3em;">Editar Receta</h3>

                <form id="edit-recipe-form" enctype="multipart/form-data">
                    <div class="form-group">
                        <label>Nombre de la receta</label>
                        <input type="text" id="edit-recipe-name" class="form-control" required>
                    </div>

                    <div class="form-group mt-3">
                        <label>Ingredientes</label>
                        <textarea id="edit-recipe-ingredients" class="form-control" required></textarea>
                    </div>

                    <div class="form-group mt-3">
                        <label>Preparación</label>
                        <textarea id="edit-recipe-preparation" class="form-control" required></textarea>
                    </div>

                    <div class="form-group mt-3">
                        <label>Nivel</label>
                        <select id="edit-recipe-level" class="form-control" required>
                            <option value="1">Nivel 1</option>
                            <option value="2">Nivel 2</option>
                            <option value="3">Nivel 3</option>
                            <option value="4">Nivel 4</option>
                            <option value="5">Nivel 5</option>
                            <option value="6">Nivel 6</option>
                            <option value="7">Nivel 7</option>
                        </select>
                    </div>

                    <div class="form-group mt-3">
                        <label>Imagen (opcional)</label>
                        <input type="file" id="edit-recipe-image" class="form-control" accept="image/*">
                    </div>

                    <!-- Cambia el tamaño del botón -->
                    <button type="submit" class="btn btn-save mt-3" style="width: 200px; height: 50px;">Guardar
                        cambios</button>

                </form>
            </div>
        </div>

        <!-- Footer -->
        <footer class="site-footer" id="contact"
            style="background-image: url(assets/images/background/blog-pattern-bg.png);">
            <div class="bottom-footer">
                <div class="container">
                    <div class="row">
                        <div class="col-lg-12 text-center">
                            <div class="copyright-text">
                                <p>Copyright &copy; 2024 <span class="name">Sabores Adaptados</span> All Rights
                                    Reserved.
                                </p>
                            </div>
                        </div>
                    </div>
                    <button class="scrolltop"><i class="uil uil-angle-up"></i></button>
                </div>
            </div>
        </footer>
    </div>
    <!-- Agrega la referencia a SweetAlert2 -->
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>

    <!-- JQuery -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
    <!-- JS para filtrar y mostrar recetas -->
    <script src="assets/js/allRecipes.js"></script>


    <!--chatbot-->
    <script src="chatbot/js/chat.js"></script>
    <script src="chatbot/js/responses.js"></script>

    <!--recipes-->
    <script src="assets/js/recipes.js"></script>

    <!-- jquery  -->
    <script src="assets/js/jquery-3.5.1.min.js"></script>

    <!-- bootstrap -->
    <script src="assets/js/bootstrap.min.js"></script>
    <script src="assets/js/popper.min.js"></script>

    <!-- fontawesome  -->
    <script src="assets/js/font-awesome.min.js"></script>

    <!-- swiper slider  -->
    <script src="assets/js/swiper-bundle.min.js"></script>

    <!-- mixitup -- filter  -->
    <script src="assets/js/jquery.mixitup.min.js"></script>

    <!-- fancy box  -->
    <script src="assets/js/jquery.fancybox.min.js"></script>

    <!-- parallax  -->
    <script src="assets/js/parallax.min.js"></script>

    <!-- gsap  -->
    <script src="assets/js/gsap.min.js"></script>

    <!-- scroll trigger  -->
    <script src="assets/js/ScrollTrigger.min.js"></script>

    <!-- scroll to plugin  -->
    <script src="assets/js/ScrollToPlugin.min.js"></script>

    <!-- smooth scroll  -->
    <script src="assets/js/smooth-scroll.js"></script>

    <!-- custom js  -->
    <script src="assets/js/main.js"></script>

    <script>
        $(document).ready(function () {
            $("a[href='home1.html']").on("click", function (e) {
                e.preventDefault(); // Prevenir la redirección automática

                // Mostrar el contenedor con el mensaje y la barra de progreso
                $("#logoutNotificationContainer").slideDown();

                // Animar la barra de progreso para indicar cierre
                $("#logoutProgressBar .progress-bar")
                    .removeClass("progress-bar-red") // Asegurarse de que no tenga clase de error
                    .addClass("progress-bar-green") // Barra verde para éxito
                    .animate({ width: "100%" }, 2000); // Llenar la barra para animar

                // Redirigir después de 2 segundos
                setTimeout(function () {
                    window.location.href = "home1.html"; // Redirigir a la página de inicio o login
                }, 2000);
            });
        });

    </script>

    <script>
        $("#add-recipe-form").on("submit", function (e) {
            e.preventDefault(); // Evitar el comportamiento predeterminado del formulario

            const formData = new FormData(); // Usar FormData para permitir archivos

            // Agregar datos al FormData
            formData.append("name", $("#recipe-name").val());
            formData.append("image", $("#recipe-image")[0].files[0]); // Archivo de imagen
            formData.append("ingredients", $("#recipe-ingredients").val());
            formData.append("preparation", $("#recipe-preparation").val());
            formData.append("level", $("#recipe-level").val());

            const loadTime = 2000; // Tiempo para la animación de la barra de carga

            // Mostrar barra de progreso y mensaje de información
            $("#addRecipeProgressBar").show();
            $("#addRecipeProgressBar .progress-bar")
                .removeClass("progress-bar-red")
                .addClass("progress-bar-green")
                .animate({ width: "100%" }, loadTime, function () {
                    // Callback cuando la barra de progreso llegue al 100%
                    $("#addRecipeProgressBar").hide(); // Ocultar la barra de progreso
                    $("#addRecipeInfoMessage").slideUp(loadTime / 2); // Ocultar el mensaje de progreso con una animación más rápida
                });

            $("#addRecipeInfoMessage").slideDown(loadTime); // Mostrar el mensaje "Agregando receta..."

            $("#addRecipeErrorMessage").hide(); // Asegurarse de que el mensaje de error esté oculto

            $.ajax({
                url: "/admin/add-recipe",
                type: "POST",
                data: formData,
                processData: false,
                contentType: false,
                success: function (response) {
                    setTimeout(() => {
                        $("#add-recipe-message")
                            .text("Receta agregada con éxito!") // Establecer el mensaje
                            .slideDown(500) // Mostrar con animación
                            .css("text-align", "center"); // Asegurar el centrado del texto
                    }, 2000); // Esperar a que la barra de progreso termine
                },
                error: function (xhr) {
                    const errorMsg = xhr.responseText || "Error desconocido";

                    setTimeout(() => {
                        $("#add-recipe-message")
                            .text("Error al agregar receta: " + errorMsg) // Mensaje de error
                            .slideDown(500)
                            .css("text-align", "center", "margin-top", "mt-3"); // Centrando el mensaje de error
                    }, 1000); // Asegurar un pequeño retardo para el mensaje de error
                },
            });

        });

    </script>
    </div>
</body>

</html>