<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Agregar Pacientes</title>
    <link rel="icon" href="assets/images/faviicon/favicon.ico" />
    <!-- for icons  -->
    <link rel="stylesheet" href="https://unicons.iconscout.com/release/v4.0.0/css/line.css">
    <!-- bootstrap  -->
    <link rel="stylesheet" href="assets/css/bootstrap.min.css">
    <!-- for swiper slider  -->
    <link rel="stylesheet" href="assets/css/swiper-bundle.min.css">
    <!-- fancy box  -->
    <link rel="stylesheet" href="assets/css/jquery.fancybox.min.css">
    <!-- custom css  -->
    <link rel="stylesheet" href="assets/css/style.css">
    <!-- chatbot css  -->
    <link rel="stylesheet" href="chatbot/css/chat.css">
    <!-- font awesome-->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
    <style>
        .main-banner {
            min-height: 80vh;
            /* Mantener la altura mínima para el fondo */
            display: flex;
            align-items: flex-start;
            /* Alinear el contenido al principio */
            justify-content: center;
            /* Mantener el centrado horizontal */
            background-image: url("assets/images/background/blog-pattern-bg.png");
            padding-top: 125px;
            /* Ajustar según sea necesario */
        }

        .sec-wp {
            text-align: center;
            padding-top: 0;
        }

        .form-container {
            width: 100%;
            max-width: 600px;
            margin: 0 auto;
            background: rgba(255, 255, 255, 0.8);
            padding: 20px;
            /* Espacio interno */
            border-radius: 10px;
            box-shadow: 0 10px 20px rgba(0, 0, 0, 0.1);
            margin-bottom: 0;

            position: relative;
            /* Asegurar que el formulario esté en el flujo normal */
            z-index: 0;
            /* Un `z-index` bajo para evitar superposiciones */
            margin-bottom: 20px;
            /* Añadir un espacio entre el formulario y el footer */

            /* Sin margen inferior para reducir espacio */
        }


        .sec-title {
            margin-bottom: 10px;
            /* Reducir espacio entre el título y el formulario */
        }

        .site-footer {
            margin-top: auto;
            /* Asegura que el footer se sitúe al final del contenedor */
            padding: 10px;
            text-align: center;
            background-color: white;
            /* Asegurar un fondo adecuado */
            z-index: 1;
            /* Asegurar que el footer esté en el orden correcto */
        }

        .bottom-footer {
            padding-top: 0;
            /* Asegúrate de que el footer no tenga relleno adicional */
        }


        .footer {
            background: rgba(255, 255, 255, 0.8);
            padding: 10px;
            border-radius: 10px;
            box-shadow: 0 10px 20px rgba(0, 0, 0, 0.1);
            margin-top: 0;
            /* Reducir margen superior para acercar el footer */
        }


        .btn-red {
            background-color: #ff8243;
            color: white;
            border: none;
            transition: background-color 0.3s;
            margin-top: 20px;
        }

        #viewport {
            min-height: 100vh;
            /* Asegurar que el contenido principal ocupe al menos toda la altura de la pantalla */
            display: flex;
            /* Utilizar Flexbox para distribuir elementos */
            flex-direction: column;
            /* Organizar los elementos verticalmente */
        }

        /* Asegurar que el contenido principal crezca para llenar el espacio */
        #js-scroll-content {
            flex-grow: 1;
            /* Hacer que el contenido principal crezca para llenar el espacio */
        }


        .btn-red:hover {
            background-color: rgb(224, 93, 6);
            color: white;
            transform: scale(1.05);
        }

        @media (max-width: 430px) {
            .form-container {
                margin-bottom: 200px;
                /* Añadir margen inferior para separar del footer */
            }

            .site-footer {
                position: fixed;
                /* Mantener el footer fijo al fondo de la pantalla */
                bottom: 0;
                /* Asegurarse de que esté en la parte inferior */
                width: 100%;
                /* Asegurar que ocupe todo el ancho de la pantalla */
                z-index: 100;
                margin-top: 100px;
                /* Añadir margen superior para separar del formulario */
                /* Para mantenerlo por encima de otros elementos */
            }
        }

        #logoutNotificationContainer {
            position: fixed;
            bottom: 0;
            /* Mantener en la parte inferior */
            left: 0;
            width: 100%;
            /* Ocupar todo el ancho */
            z-index: 999;
            /* Asegurarse de que esté por encima de otros elementos */
            background-color: #f8f9fa;
            /* Fondo para el contenedor */
            padding: 10px;
            /* Espaciado interno */
        }

        /* Barra de progreso verde */
        .progress-bar-green {
            background-color: rgb(255, 146, 82);
            /* Color verde para éxito */
        }

        /* Barra de progreso verde */
        .progress-bar-green1 {
            background-color: #28a745;
            /* Color verde para éxito */
        }

        #addPatientInfoMessage {
            background-color: #89ffa4;
            /* Verde Bootstrap, por ejemplo */
            color: white;
            /* Texto blanco para buen contraste */
            padding: 10px;
            /* Agregar algo de espacio interno */
            border-radius: 5px;
            /* Bordes redondeados */
            text-align: center;
            /* Centrar el texto */
            display: none;
            /* Inicialmente oculto */
        }


        /* Estilo para el mensaje de cierre de sesión */
        .alert-success {
            color: rgb(170, 73, 16);
            /* Color del texto para el mensaje de éxito */
            background-color: rgb(230, 210, 199);
            /* Fondo verde claro */
            border-color: #c3e6cb;
            /* Borde del mismo tono */
        }

        </style
    </style>
</head>

<body>
    <!-- Contenedor para el mensaje de cierre de sesión y la barra de progreso -->
    <div id="logoutNotificationContainer"
        style="display: none; position: fixed; bottom: 0; left: 0; width: 100%; z-index: 999;">
        <!-- Barra de progreso para el cierre de sesión -->
        <div id="logoutProgressBar" class="progress" style="height: 5px; margin-top: 5px;">
            <div class="progress-bar progress-bar-striped progress-bar-animated progress-bar-green" role="progressbar"
                style="width: 0%;">
            </div>
        </div>

        <!-- Mensaje para el cierre de sesión -->
        <div id="logoutSuccessMessage" class="alert alert-success text-center" style="margin: 0;">
            Cerrando sesión...
        </div>
    </div>

    <!-- Header  -->
    <header class="site-header">
        <div class="container">
            <div class="row">
                <div class="col-lg-2 mt-4">
                    <div class="header-logo">
                        <img src="assets/images/logo.png" width="300" height="100" alt="Logo">
                    </div>
                </div>
                <div class="col-lg-10">
                    <div class="main-navigation">
                        <button class="menu-toggle"><span></span><span></span></button>
                        <nav class="header-menu">
                            <ul class="menu food-nav-menu">
                                <li><a href="home-admin.html">Inicio</a></li>
                                <li><a href="form.html">Agregar Pacientes</a></li>
                                <li><a href="view-patients.html">Ver Pacientes</a></li>
                                <li><a href="allRecipes.html">Ver Recetas</a></li>
                                <li><a href="home1.html">Cerrar Sesión</a></li>
                            </ul>
                            </ul>
                        </nav>
                    </div>
                </div>
            </div>
        </div>
    </header>
    <!-- Home  -->
    <div id="viewport">
        <div id="js-scroll-content">
            <section class="main-banner" id="home"
                style="background-image: url(assets/images/background/blog-pattern-bg.png);">
                <div class="book-table-shape">
                    <img src="assets/images/background/table-leaves-shape.png" alt="">
                </div>

                <div class="book-table-shape book-table-shape2">
                    <img src="assets/images/background/table-leaves-shape.png" alt="">
                </div>
                <div class="js-parallax-scene">
                    <div class="banner-shape-1 w-100" data-depth="0.30">
                        <img src="assets/images/background/berry.png" alt="">
                    </div>
                    <div class="banner-shape-2 w-100" data-depth="0.25">
                        <img src="assets/images/background/leaf.png" alt="">
                    </div>
                </div>
                <div class="sec-wp">
                    <div class="container" id="add-patient">
                        <div class="container">
                            <div class="col-lg-12">
                                <div class="sec-title text-center mb-5">
                                    <p class="sec-sub-title mb-3 mt-3">Agregar Pacientes</p>
                                    <h2 class="h2-title">Ingresar Datos del Paciente</h2>
                                    <div class="sec-title-shape mb-4">
                                        <img src="assets/images/figure/title-shape.svg" alt="">
                                    </div>
                                    <form id="add-patient-form" class="form-container">
                                        <div class="form-group">
                                            <label para="patient-name">Nombre</label>
                                            <input type="text" id="patient-name" class="form-control" required>
                                        </div>
                                        <div class="form-group">
                                            <label para="patient-surname">Apellido</label>
                                            <input type="text" id="patient-surname" class="form-control" required>
                                        </div>
                                        <div class="form-group">
                                            <label para="patient-dni">DNI</label>
                                            <input type="text" id="patient-dni" class="form-control" required>
                                        </div>
                                        <div class="form-group">
                                            <label para="patient-birthdate">Fecha de Nacimiento</label>
                                            <input type="date" id="patient-birthdate" class="form-control" required>
                                        </div>
                                        <div class="form-group">
                                            <label para="health-report">Informe de Salud</label>
                                            <textarea id="health-report" class="form-control" required></textarea>
                                        </div>
                                        <div class="form-group">
                                            <label para="patient-level">Nivel de adaptación</label>
                                            <select id="patient-level" class="form-control" required>
                                                <option value="">Seleccione nivel de adaptación</option>
                                                <option value="1">Nivel 1</option>
                                                <option value="2">Nivel 2</option>
                                                <option value="3">Nivel 3</option>
                                                <option value="4">Nivel 4</option>
                                                <option value="5">Nivel 5</option>
                                                <option value="6">Nivel 6</option>
                                                <option value="7">Nivel 7</option>
                                            </select>
                                        </div>
                                        <button type="submit" class="btn btn-red">Agregar Paciente</button>
                                    </form>
                                    <div id="add-patient-message"></div>
                                </div>
                                <!-- Barra de progreso para el proceso de agregar paciente -->
                                <div id="addPatientProgressBar" class="progress" style="height: 5px; display: none;">
                                    <div class="progress-bar progress-bar-striped progress-bar-animated progress-bar-green1"
                                        role="progressbar" style="width: 0%;">
                                    </div>
                                </div>
                                <!-- Mensaje de información para indicar que se está agregando el paciente -->
                                <div id="addPatientInfoMessage" class="alert alert-success text-center"
                                    style="display: none;">
                                    Añadiendo paciente...
                                </div>
                                <!-- Mensaje de error para indicar problemas al agregar paciente -->
                                <div id="addPatientErrorMessage" class="alert alert-danger text-center"
                                    style="display: none;">
                                    Error al agregar paciente.
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </section>
            <!-- Footer -->
            <footer class="site-footer" id="contact"
                style="background-image: url(assets/images/background/blog-pattern-bg.png);">
                <div class="bottom-footer">
                    <div class="container">
                        <div class="row">
                            <div class="col-lg-12 text-center">
                                <div class="copyright-text">
                                    <p>Copyright &copy; 2024 <span class="name">Sabores Adaptados</span> All Rights
                                        Reserved.
                                    </p>
                                </div>
                            </div>
                        </div>
                        <button class="scrolltop"><i class="uil uil-angle-up"></i></button>
                    </div>
                </div>
            </footer>
        </div>


        <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
        <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>
        <script>
            $("#add-patient-form").on("submit", function (e) {
                e.preventDefault(); // Prevenir el comportamiento predeterminado del formulario

                const patientData = {
                    name: $("#patient-name").val(),
                    surname: $("#patient-surname").val(),
                    dni: $("#patient-dni").val(),
                    birthDate: $("#patient-birthdate").val(),
                    healthReport: $("#health-report").val(),
                    level: $("#patient-level").val(),
                };

                const loadTime = 2000; // Duración para la animación de la barra de carga

                // Mostrar la barra de progreso y el mensaje de información
                $("#addPatientProgressBar").show();
                $("#addPatientProgressBar .progress-bar")
                    .removeClass("progress-bar-red")
                    .addClass("progress-bar-green")
                    .animate({ width: "100%" }, loadTime, function () {
                        $("#addPatientProgressBar").hide(); // Ocultar la barra de progreso
                        $("#addPatientInfoMessage").slideUp(loadTime / 2); // Ocultar el mensaje de progreso
                    });

                $("#addPatientInfoMessage").slideDown(loadTime); // Mostrar el mensaje "Añadiendo paciente..."

                $("#addPatientErrorMessage").hide(); // Asegurarse de que el mensaje de error esté oculto

                $.post("/admin/add-patient", patientData, function (data) {
                    // Esperar un tiempo adicional antes de mostrar el mensaje de éxito
                    setTimeout(() => {
                        $("#add-patient-message").text("Paciente agregado con éxito.").slideDown(500); // Mensaje de éxito
                    }, loadTime); // Esperar a que termine la barra antes de mostrar el mensaje de éxito
                }).fail(function (xhr) {
                    const errorMsg = xhr.responseText || "Error desconocido";

                    $("#addPatientProgressBar .progress-bar")
                        .removeClass("progress-bar-green")
                        .addClass("progress-bar-red")
                        .css("width", "100%");

                    // Aumentar el tiempo de espera antes de mostrar el mensaje de error
                    setTimeout(() => {
                        $("#addPatientErrorMessage").text("Error: " + errorMsg).slideDown(1000); // Mostrar el mensaje de error
                        $("#addPatientInfoMessage").slideUp(1000); // Ocultar el mensaje de progreso
                    }, loadTime); // Esperar hasta que la barra de progreso termine
                });
            });


        </script>

        <script>
            window.addEventListener("scroll", function () {
                const scrollTopButton = document.querySelector(".scrolltop");
                if (window.scrollY > 100) { // Si se desplaza más de 100px, mostrar el botón
                    scrollTopButton.style.opacity = 1; // Hacer visible el botón
                } else {
                    scrollTopButton.style.opacity = 0; // Ocultar el botón
                }
            });

            // Evento para hacer scroll hacia arriba cuando se hace clic en el botón
            document.querySelector(".scrolltop").addEventListener("click", function () {
                window.scrollTo({ top: 0, behavior: "smooth" }); // Scroll suave hacia arriba
            });

            $(document).ready(function () {
                $("a[href='home1.html']").on("click", function (e) {
                    e.preventDefault(); // Evitar la redirección automática

                    // Mostrar el contenedor con el mensaje y la barra de progreso
                    $("#logoutNotificationContainer").slideDown(); // Deslizar hacia abajo para mostrar

                    // Animar la barra de progreso
                    $("#logoutProgressBar .progress-bar")
                        .removeClass("progress-bar-red") // Asegurarse de que no tenga clase de error
                        .addClass("progress-bar-green") // Barra verde para éxito
                        .animate({ width: "100%" }, 2000); // Animar para llenar la barra

                    // Redirigir después de 2 segundos
                    setTimeout(function () {
                        window.location.href = "home1.html"; // Redirigir a la página de inicio o login
                    }, 2000);
                });
            });
        </script>
        <!--recipes-->
        <script src="assets/js/recipes.js"></script>

        <!-- jquery  -->
        <script src="assets/js/jquery-3.5.1.min.js"></script>

        <!-- bootstrap -->
        <script src="assets/js/bootstrap.min.js"></script>
        <script src="assets/js/popper.min.js"></script>

        <!-- fontawesome  -->
        <script src="assets/js/font-awesome.min.js"></script>

        <!-- swiper slider  -->
        <script src="assets/js/swiper-bundle.min.js"></script>

        <!-- mixitup -- filter  -->
        <script src="assets/js/jquery.mixitup.min.js"></script>

        <!-- fancy box  -->
        <script src="assets/js/jquery.fancybox.min.js"></script>

        <!-- parallax  -->
        <script src="assets/js/parallax.min.js"></script>

        <!-- gsap  -->
        <script src="assets/js/gsap.min.js"></script>

        <!-- scroll trigger  -->
        <script src="assets/js/ScrollTrigger.min.js"></script>

        <!-- scroll to plugin  -->
        <script src="assets/js/ScrollToPlugin.min.js"></script>

        <!-- smooth scroll  -->
        <script src="assets/js/smooth-scroll.js"></script>

        <!-- custom js  -->
        <script src="assets/js/main.js"></script>
    </div>
</body>

</html>